{% extends 'layout.html' %}

{% block title %}
    {% if action == 'create' %}Criar Usuário{% else %}Editar Usuário{% endif %}
{% endblock %}

{% block content %}
<h1>{% if action == 'create' %}Criar Novo Usuário{% else %}Editar Usuário{% endif %}</h1>
<form method="post" class="user-form">
    <div class="input-group">
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" value="{{ user.email if user else '' }}" 
               required {% if action == 'edit' %}readonly{% endif %}>
        {% if action == 'edit' %}
            <small>(O email não pode ser alterado)</small>
        {% endif %}
    </div>
    
    {% if action == 'create' %}
    <div class="input-group">
        <label for="password">Senha:</label>
        <input type="password" id="password" name="password" required>
    </div>
    {% endif %}

    <div class="input-group">
        <label for="role">Nível de Acesso:</label>
        <select id="role" name="role" required>
            <option value="admin" {% if user.role == 'admin' %}selected{% endif %}>Admin</option>
            <option value="diretoria" {% if user.role == 'diretoria' %}selected{% endif %}>Diretoria</option>
            <option value="comercial" {% if user.role == 'comercial' %}selected{% endif %}>Comercial</option>
            <option value="financeiro" {% if user.role == 'financeiro' %}selected{% endif %}>Financeiro</option>
            <option value="default" {% if user.role == 'default' %}selected{% endif %}>Padrão (sem acesso)</option>
        </select>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn">
            {% if action == 'create' %}Criar Usuário{% else %}Salvar Alterações{% endif %}
        </button>
        <a href="{{ url_for('admin.manage_users') }}" class="btn btn-secondary">Cancelar</a>
    </div>
</form>
{% endblock %}